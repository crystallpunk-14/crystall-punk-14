- type: entity
  id: CP14ActionSpellCompression
  name: Compression
  description: you compress and curl the object inside itself, temporarily turning it into a small stone.
  components:
  - type: Sprite
    sprite: _CP14/Actions/Spells/dimension.rsi
    state: compression
  - type: CP14MagicEffectCastSlowdown
    speedMultiplier: 0.5
  - type: CP14MagicEffectManaCost
    manaCost: 30
  - type: CP14MagicEffect
    telegraphyEffects:
    - !type:CP14SpellSpawnEntityOnTarget
      spawns:
      - CP14ImpactEffectCompression
    effects:
    - !type:CP14SpellSpawnEntityOnTarget
      spawns:
      - CP14ImpactEffectCompression
    - !type:CP14SpellApplyEntityEffect
      effects:
      - !type:Polymorph
        prototype: CP14CompressionStone
  - type: CP14MagicEffectVerbalAspect
    startSpeech: "specialis theoria..."
    endSpeech: "relativitatis"
  - type: CP14MagicEffectCastingVisual
    proto: CP14RuneSheepPolymorph
  - type: EntityTargetAction
    whitelist:
      components:
      - Item
      - Storage
    range: 3
    itemIconStyle: BigAction
    interactOnMiss: false
    sound: !type:SoundPathSpecifier
      path: /Audio/Magic/rumble.ogg
    icon:
      sprite: _CP14/Actions/Spells/dimension.rsi
      state: compression
    event: !type:CP14DelayedEntityTargetActionEvent
      cooldown: 30
      castDelay: 1.5
      breakOnMove: false

- type: entity
  id: CP14ImpactEffectCompression
  parent: CP14BaseMagicImpact
  categories: [ HideSpawnMenu ]
  save: false
  components:
  - type: Sprite
    sprite: Effects/electricity.rsi
    layers:
    - state: electrified
      color: "#5e427e"

- type: entity
  parent: CP14BaseSpellScrollDimension
  id: CP14SpellScrollCompression
  name: compression spell scroll
  components:
  - type: CP14SpellStorage
    spells:
    - CP14ActionSpellCompression
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 30

- type: entity
  parent: BaseItem
  id: CP14CompressionStone
  categories: [ ForkFiltered ]
  name: compression stone
  description: the compressed and curled object
  components:
  - type: Item
    size: Small
    shape:
    - 0,0,0,0
  - type: Sprite
    sprite: /Textures/_CP14/Structures/Dungeon/demiplan_rift_core.rsi
    layers:
    - state: core
  - type: SingularityDistortion
    falloffPower: 1
    intensity: 1