- type: entity
  id: CP14BaseRitualPhase
  abstract: true
  components:
  - type: CP14MagicRitualPhase
  - type: Tag
    tags:
      - HideContextMenu

- type: entity
  parent: CP14FoodCucumber
  id: RitualCucumber
  name: ritual cucumber
  components:
  - type: CP14MagicRitual
    startPhase: CP14RitualPhaseStartpoint

- type: entity
  parent: CP14BaseRitualPhase
  id: CP14RitualPhaseStartpoint
  name: нейтральный исходный узел
  components:
  - type: PointLight
    color: "#FFFF00"
  - type: CP14RitualTriggerVoice
    failAttempts: 3
    failedPhase: CP14RitualPhaseFailed
    triggers:
    - targetPhase: CP14RitualPhaseSecond
      message: "Singulo"
  - type: CP14MagicRitualPhase
    edges:
    - target: CP14RitualPhaseFailed
      
      actions: 
      - !type:SpawnEntity
        proto: CP14FoodCucumber
        count: 3
      
    - target: CP14RitualPhaseSecond
      requirements:
      - !type:RequiredResource
        vfx: CP14ImpactEffectShadowGrab
        checkRange: 3
        requiredEntities:
          CP14FoodCucumber: 3
        requiredStack:
          CP14WoodenPlanks: 2
      - !type:RequiredStability
        min: 0.5

      actions: 
      - !type:EditStability
        mod: -0.1
      - !type:ConsumeResource
        checkRange: 3
        requiredEntities:
          CP14FoodCucumber: 2
        requiredStack:
          CP14WoodenPlanks: 1
      - !type:ApplyEntityEffect
        maxEntities: 3
        vfx: CP14ImpactEffectCureWounds
        whitelist:
          components:
          - Damageable
        effects:
          - !type:HealthChange
            damage:
              types:
                Slash: -10
                Blunt: -10
                Piercing: -10
                Heat: -10
          - !type:Jitter


- type: entity
  parent: CP14BaseRitualPhase
  id: CP14RitualPhaseSecond
  name: темпоральный огуречный узел
  components:
  - type: PointLight
    color: "#FF00FF"
  - type: EmitSoundOnSpawn
    sound: 
      path: /Audio/Effects/tesla_consume.ogg
      params:
        variation: 0.3
  - type: CP14RitualTriggerTimer
    nextPhase: CP14RitualPhaseStartpoint
    time:
      min: 5
      max: 10
  - type: CP14MagicRitualPhase
    edges:
    - target: CP14RitualPhaseStartpoint # To start

- type: entity
  parent: CP14BaseRitualPhase
  id: CP14RitualPhaseFailed
  name: нестабильный темпоральный узел
  components:
  - type: PointLight
    color: "#FF0000"
  - type: EmitSoundOnSpawn
    sound: 
      path: /Audio/Effects/tesla_consume.ogg
      params:
        variation: 0.6
  - type: CP14RitualTriggerTimer
    nextPhase: CP14RitualPhaseStartpoint
    time:
      min: 5
      max: 10
  - type: CP14MagicRitualPhase
    edges:
    - target: CP14RitualPhaseStartpoint # To start